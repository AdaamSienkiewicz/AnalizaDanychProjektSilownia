---
title: "<span style='font-size: 40px;'>Projekt z Analizy Danych - Siłownia </span>"
author: |
  <p>Aleksandra Ochocińska</p>
  <p>Mateusz Wasiewski</p>
  <p>Adam Sienkiewicz</p>
output:
  rmdformats::downcute:
    highlight: kate
    theme: "yeti" 
    font: "Roboto"  
    code_font: "Courier New"  
    highlight_style: "zenburn"  
    fig_caption: true  
    theme_color: "##ADD8E6"  
    highlight_color: "##ADD8E6"  
---

# **Wprowadzenie**

## **1. Wstęp**

Celem projektu jest przeprowadzenie analizy danych na zbiorze Siłownia. Jest to zestaw danych zawierający szczegółowy przegląd rutynowych ćwiczeń wykonywanych przez członków siłowni, a także ich atrybutów fizycznych i wskaźników sprawności. Proces analizy danych będzie składał się z kilku etapów, które kolejno obejmują: przygotowanie danych (data wrangling), stworzenie wizualizacji oraz statystyk opisowych, wnioskowanie statystyczne, a na końcu podsumowanie całej pracy.

Data Wrangling obejmie identyfikację obserwacji odstających, analizę brakujących danych, imputację braków oraz walidację danych.

Następnie, w etapie wizualizacji i statystyk opisowych, zostanie zaprezentowany szeroki zakres analiz, mających na celu wydobycie jak najbardziej użytecznych informacji z dostępnych danych.

Wnioskowanie statystyczne będzie polegało na przeprowadzaniu testów statystycznych oraz analizie zależności między zmiennymi, co pozwoli na wyciąganie uogólnionych wniosków dotyczących całej populacji na podstawie dostępnej próby danych.

Ostatnią częścią projektu będzie podsumowanie, w którym zostaną przedstawione najważniejsze wnioski i informacje wynikające z przeprowadzonej analizy.

## **2. Zmienne w zbiorze danych**

• **Age** - wiek użytkownika siłowni.

• ***Gender*** - płeć użytkownika siłowni.

• ***Weight (kg)***- waga użytkownika siłowni w kilogramach.

• ***Height (m)*** - wzrost użytkownika siłowni w metrach.

• ***Max_BPM*** - maksymalne tętno podczas sesji treningowych.

• ***Avg_BPM*** - średnie tętno podczas sesji treningowych.

• ***Resting_BPM*** - spoczynkowe tętno przed treningiem.

• ***Session_Duration*** - czas trwania każdej sesji treningowej w godzinach.

• ***Calories_Burned*** - całkowita liczba kalorii spalonych podczas każdej sesji.

• ***Workout_Type*** - rodzaj wykonanego treningu (np. kardio, siłowy, joga, HIIT).

• ***Fat_Percentage*** -procent tkanki tłuszczowej.

• ***Water_Intake*** - spożycie wody podczas treningu w litrach.

• ***Workout_Frequency*** - liczba sesji treningowych w tygodniu.

• ***Experience_Level*** - poziom doświadczenia, od początkującego (1) do eksperta (3).

• ***BMI*** - wskaźnik masy ciała, obliczany na podstawie wzrostu i wagi.

## **3. Struktura danych**

<!-- Wczytanie danych-->

```{r include=FALSE}
# Ustawienie lustra CRAN
options(repos = c(CRAN = "https://cran.rstudio.com"))
#Wczytanie danych
install.packages("readr")
install.packages("skimr")
library("readr")
library(skimr)
silownia <- read_csv("silownia_new.csv")
```

```{r include=FALSE}
skim(silownia)
```

|                             |          |
|-----------------------------|----------|
| **Nazwa zbioru danych**     | silownia |
| **Liczba wierszy**          | 973      |
| **Liczba kolumn**           | 15       |
| **Kolumny typu tekstowego** | 2        |
| **Kolumny typu liczbowego** | 13       |

**Kolumny typu tekstowego**

| **Kolumna** | **Brakujące wartości** | **Kompletność** | **Min** | **Max** | **Puste** | **Unikalne wartości** | **Whitespace** |
|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|
| Płeć | 0 | 1.00 | 4 | 6 | 0 | 2 | 0 |
| Typ treningu | 150 | 0.85 | 4 | 8 | 0 | 4 | 0 |

**Kolumny typu liczbowego**

| **Kolumna** | **Brakujące wartości** | **Kompletność** | **Średnia** | **Odchylenie standardowe** | **0 Percentyl** | **25 Percentyl** | **50 Percentyl** | **75 Percentyl** | **100 Percentyl** | **Histogram** |
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
| Wiek | 100 | 0.90 | 38.63 | 12.27 | 18.00 | 28.00 | 39.00 | 50.00 | 59.00 | ▇▆▆▇▇ |
| Waga | 0 | 1.00 | 73.85 | 21.21 | 40.00 | 58.10 | 70.00 | 86.00 | 129.90 | ▅▇▅▂▂ |
| Wzrost | 0 | 1.00 | 1.72 | 0.13 | 1.50 | 1.62 | 1.71 | 1.80 | 2.00 | ▅▇▇▃▃ |
| Maksymalne tętno | 0 | 1.00 | 179.88 | 11.53 | 160.00 | 170.00 | 180.00 | 190.00 | 199.00 | ▇▇▇▇▇ |
| Średnie tętno | 0 | 1.00 | 143.77 | 14.35 | 120.00 | 131.00 | 143.00 | 156.00 | 169.00 | ▇▇▆▆▆ |
| Spoczynkowe tętno | 0 | 1.00 | 62.22 | 7.33 | 50.00 | 56.00 | 62.00 | 68.00 | 74.00 | ▇▆▇▇▇ |
| Czas trwania sesji | 0 | 1.00 | 1.26 | 0.34 | 0.50 | 1.04 | 1.26 | 1.46 | 2.00 | ▂▅▇▃▂ |
| Spalone kalorie | 0 | 1.00 | 905.42 | 272.64 | 303.00 | 720.00 | 893.00 | 1076.00 | 1783.00 | ▃▇▇▂▁ |
| Procent tkanki tłuszczowej | 0 | 1.00 | 24.98 | 6.26 | 10.00 | 21.30 | 26.20 | 29.30 | 35.00 | ▂▂▅▇▅ |
| Spożycie wody | 0 | 1.00 | 2.63 | 0.60 | 1.50 | 2.20 | 2.60 | 3.10 | 3.70 | ▃▆▇▃▆ |
| Częstotliwość treningów | 0 | 1.00 | 3.32 | 0.91 | 2.00 | 3.00 | 3.00 | 4.00 | 5.00 | ▅▇▁▆▂ |
| Poziom doświadczenia | 0 | 1.00 | 1.81 | 0.74 | 1.00 | 1.00 | 2.00 | 2.00 | 3.00 | ▇▁▇▁▃ |
| BMI | 150 | 0.85 | 24.82 | 6.60 | 12.32 | 20.10 | 23.94 | 28.45 | 47.72 | ▃▇▅▁▁ |

## **4. Wstępne przygotowanie danych**

Przed rozpocząciem procesu Data Wranglingu pobraliśmy i zainstalowaliśmy wszystkie niezbędne pakiety potrzebne do naszej analizy. Kolejnym krokiem była zmiana nazw kolumn z :

```{r include=FALSE}
#Zainstalowanie wszystkich biblotek oraz ich wczytanie
# Lista pakietów (poprawiona składnia)
packages <- c(
  "dplyr", "readr", "naniar", "ggplot2", "rmdformats", "validate", "validatetools", 
  "dcmodify", "errorlocate", "deductive", "VIM", "simputation", "visdat", 
  "lumberjack", "ISLR", "dlookr", "xts", "quantmod", "ROCR", "mice", 
  "Information", "scorecard", "tidyverse", "plotly", "rpart", "psych", "stats", "qwraps2", "kableExtra", "ggstatsplot"
)

# Funkcja instalująca i ładująca pakiety
install_if_missing <- function(packages) {
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE)) { 
      install.packages(pkg)                    # Instalacja pakietu, jeśli go brakuje
    }
    library(pkg, character.only = TRUE)        # Ładowanie pakietu
  }
}

# Wywołanie funkcji
install_if_missing(packages)
```

```{r include=FALSE}
silownia <- read_csv("silownia_new.csv")
```

-   Weight (kg) na Weight_kg

-   Height (m) na Height_m

-   Session_Duration (hours) na Session_Duration_hours

-   Water_Intake (liters) na Water_Intake_liters

-   Workout_Frequency (days/week) na Workout_Frequency_daysweek

```{r include=FALSE}
colnames(silownia)[colnames(silownia) == "Weight (kg)"] <- "Weight_kg"
colnames(silownia)[colnames(silownia) == "Height (m)"] <- "Height_m"
colnames(silownia)[colnames(silownia) == "Session_Duration (hours)"] <- "Session_Duration_hours"
colnames(silownia)[colnames(silownia) == "Water_Intake (liters)"] <- "Water_Intake_liters"
colnames(silownia)[colnames(silownia) == "Workout_Frequency (days/week)"] <- "Workout_Frequency_daysweek"
```

# **Data wrangling**

Data wrangling jest to proces polegający na przekształceniu nieuporządkowanego zbioru danych w użyteczny oraz uporządkowany. To złożone działanie, które zaczyna się od zrozumienia struktury danych i identyfikacji problemów, a kończy na stworzeniu uporządkowanego zbioru gotowego do dalszej analizy.

Kluczowymi etapami tego procesu będzie:

-   poznanie obserwacji odstających, czyli danych które w znaczący sposób różnią się od reszty zbioru

-   przeanalizowanie braków danych, w którym poznamy ilość braków, ich rozmieszczenie, a także czy występuje współzależność między nimi

-   imputacja braków danych, polegająca na zastąpieniu braków za pomocą metod imputacji

-   walidacja danych, czyli sprawdzenie czy dane są wolne od błędów

## **1. Obserwacje odstające**

Obserwacje odstające to dane, które znacząco różnią się od reszty zbioru, co może wynikać z błędów pomiaru, specyfiki badanego zjawiska lub innych nietypowych czynników. W celu poznania obserwacji odstających w naszym zbiorze danych zastowaliśmy wykres ramkowy (*box plot*), pozwalający na wizualne wykrycie wartości wykraczających poza typowy zakres danych.

#### **Wiek**

```{r echo=FALSE}
boxplot(silownia$Age)
```

Zmienna *Wiek* nie posiada obserwacji odstających.

#### **Waga**

```{r echo=FALSE}
boxplot(silownia$Weight_kg)
```

Zmienna *Waga* posiada odstające obserwacje (górne outliery), czyli obserwacje, które znajdują się o więcej niż 1,5 rozstępu ćwiartkowego powyżej trzeciego kwartyla.

#### **Wzrost**

```{r echo=FALSE}
boxplot(silownia$Height_m)
```

Zmienna *Wzrost* nie ma obserwacji odstających.

#### **Maksymalne tętno**

```{r echo=FALSE}
boxplot(silownia$Max_BPM)
```

Zmienna *Maksymalne tętno* nie posiada obserwacji odstających.

#### **Średnie tętno**

```{r echo=FALSE}
boxplot(silownia$Avg_BPM) 
```

Zmienna *Średnie tętno* nie ma obserwacji odstających.

#### **Tętno spoczynkowe**

```{r echo=FALSE}
boxplot(silownia$Resting_BPM)
```

Zmienna *Tętno spoczynkowe* nie ma obserwacji odstających.

#### **Czas trwania sesji**

```{r echo=FALSE}
boxplot(silownia$Session_Duration_hours)
```

Zmienna *Czas trwania sesji* nie posiada obserwacji odstających.

#### **Spalone kalorie**

```{r echo=FALSE}
boxplot(silownia$Calories_Burned)
```

Zmienna *Spalone kalorie* posiada górne outliery, czyli obserwacje, które znajdują się o więcej niż 1,5 rozstępu ćwiartkowego powyżej trzeciego kwartyla.

#### **Procent tkanki tłuszczowej**

```{r echo=FALSE}
boxplot(silownia$Fat_Percentage)
```

Zmienna *Procent tkanki tłuszczowej* nie ma obserwacji odstających.

#### **Ilość wypitej wody**

```{r echo=FALSE}
boxplot(silownia$Water_Intake_liters)
```

Zmienna *Ilość wypitej wody* nie posiada obserwacji odstających.

#### **Częstotliwość treningów**

```{r echo=FALSE}
boxplot(silownia$Workout_Frequency_daysweek)
```

Zmienna *Częstotliwość treningów* nie posiada obserwacji odstających.

#### **BMI**

```{r echo=FALSE}
boxplot(silownia$BMI)
```

W przypadku zmiennej *BMI* występują górne outliery, czyli obserwacje, które znajdują się o więcej niż 1,5 rozstępu ćwiartkowego powyżej trzeciego kwartyla.

#### **Podsumowanie**

Za pomocą wykresu ramkowego wykazano, że w przypadku zmiennych ***Waga***, ***Spalone kalorie*** oraz ***BMI*** występują górne outliery,czyli obserwacje, które znajdują się o więcej niż 1,5 rozstępu ćwiartkowego powyżej trzeciego kwartyla. Żadna zmienna natomiast nie posiada ekstremalnych obserwacji odstających.

## **2. Analiza braków danych**

Analiza braków danych jest kluczowym etapem przygotowania zbioru danych do dalszej analizy. W ramach tego procesu określimy liczbę braków w zbiorze, przeanalizujemy ich rozmieszczenie oraz sprawdzimy, czy występują korelacje między brakami w różnych zmiennych. Wyniki tej analizy posłużą jako podstawa do podjęcia decyzji o dalszym postępowaniu z brakującymi danymi.

### **Wstępna analiza braków danych**

#### **Sprawdzenie gdzie występują braki danych i procentowo ile ich jest**

```{r echo=FALSE}
vis_miss(silownia)
```

W całej bazie danych brakuje 2,7% danych.

Braki danych występują w kolumnie *Typ treningu, Wiek* oraz *BMI*.

#### **Ile braków jest w poszczególnych kolumnach**

```{r echo=FALSE}
gg_miss_var(silownia)

```

```{r include=FALSE}
colSums(is.na(silownia))
```

Kolumna *Wiek* ma 100 braków.

Kolumna *Typ treningu* ma 150 braków.

Kolumna *BMI* ma 150 braków.

```{r include=FALSE}
vis_dat(silownia)
```

#### **Występowanie braków w wierszach**

```{r include=FALSE}
kolumny_z_NA <- silownia %>% 
                  select(Age, Workout_Type, BMI)
gg_miss_upset(silownia, nsets= 3)
```

```{r include=FALSE}
miss_case_table(silownia)
```

| Liczba NA w wierszu | Liczba wierszy | Procent wszystkich wierszy |
|---------------------|----------------|----------------------------|
| 0                   | 631            | 64,85%                     |
| 1                   | 287            | 29,50%                     |
| 2                   | 52             | 5,34%                      |
| 3                   | 3              | 0,31%                      |

631 wierszy ma 0 NA

287 wierszy ma 1 NA

-   115 w *Typ treningu*

-   106 w *BMI*

-   66 w *Wiek*

52 wiersze ma 2 NA

-   21 wierszy w *Typ treningu* i *BMI*

-   20 wierszy w *Wiek* i *BMI*

-   11 w *Wiek* i *Typ treningu*

3 wiersze mają 3 NA

#### **Sprawdzanie korelacji między brakami danych**

**1. Wiek i BMI**

```{r echo=FALSE, warning=FALSE}
ggplot(data = silownia, aes(x = Age, y = BMI)) + 
  geom_point() +
  geom_miss_point() +
  scale_color_manual(values = c("darkorange","cyan4")) +
  theme_minimal()
```

Braki w kolumnie *BMI* są całkowicie niezależne od wartości w kolumnie *Wiek*.

Z kolei braki w kolumnie *Wiek* są raczej niezależne od wartości *BMI*, choć zauważono nieco większą liczbę braków w przypadku niższych wartości *BMI*.

**2. Typ treningu i BMI**

```{r echo=FALSE, warning=FALSE}
ggplot(data = kolumny_z_NA, aes(x = Workout_Type, y = BMI)) + 
  geom_point() +
  geom_miss_point() +
  scale_color_manual(values = c("darkorange","cyan4")) +
  theme_minimal()
```

Braki w kolumnie *BMI* są całkowicie niezależne od wartości w kolumnie *Typ treningu*.

Z kolei braki w kolumnie *Typ treningu* są raczej niezależne od wartości *BMI*, choć zauważono nieco większą liczbę braków w przypadku niższych wartości *BMI.*

**3. Typ treningu i Wiek**

```{r echo=FALSE, warning=FALSE}
ggplot(data = kolumny_z_NA, aes(x = Workout_Type, y = Age)) + 
  geom_point() +
  geom_miss_point() +
  scale_color_manual(values = c("darkorange","cyan4")) +
  theme_minimal()
```

Braki w obu kolumnach są całkowicie niezależne od siebie.

## **3. Imputacja braków danych**

W procesie analizy braków danych napotkaliśmy na brakujące wartości (NA) w kolumnach ***Wiek**, **BMI*** oraz ***Typ treningu***. Aby zapewnić spójność i pełność danych, postanowiliśmy przeprowadzić imputację braków, czyli zastąpienie brakujących wartości odpowiednimi danymi.

#### **Kolumna BMI**

Braki w kolumnie postanowaliśmy zastąpić za pomocą wzoru na BMI.

$$
BMI = \frac{waga}{wzrost^2}
$$

```{r echo=TRUE}
silownia$BMI <- ifelse(
  is.na(silownia$BMI),  
  silownia$Weight_kg / (silownia$Height_m^2),  
  silownia$BMI )
```

Wybraliśmy wzór na BMI jako metodę uzupełniania braków, ponieważ opiera się on na dwóch kluczowych zmiennych: wadze i wzroście, które w naszym zbiorze danych są kompletne. Dzięki temu obliczenie BMI za pomocą wzrou jest najbardziej rzetelną metodą imputacji, gdyż wykorzystuje dostępne, pełne informacje do oszacowania brakujących wartości.

#### **Kolumna Typ treningu i Wiek**

W przypadku kolumny *Typ treningu* i *Wiek* zdecydowaliśmy przeprowadzić imputację na kilka sposób, a następnie wybrać najlepszą możliwość.

**1. Imputacja metodą k-Nearest Neighbors (kNN)**

```{r}
silownia_kNN <- kNN(silownia, k = 3)

```

**2. Imputacja z pakietem Mice**

```{r echo=TRUE, eval=FALSE, message=FALSE, warning=FALSE}
if (!is.factor(silownia$Workout_Type)) {
  silownia$Workout_Type <- factor(silownia$Workout_Type, levels = c("Yoga", "Cardio", "HIIT", "Strength"))
}

metody <- make.method(silownia)

metody["Age"] <- "pmm"
metody["Workout_Type"] <- "polyreg"
metody["BMI"] <- "" 

pred_mat <- make.predictorMatrix(silownia)
pred_mat["BMI", ] <- 0 # Wyłącz imputację dla BMI
pred_mat[, "BMI"] <- 1 # BMI jako predyktor dla innych kolumn

silownia_imp <- mice(silownia, m = 5, method = metody, predictorMatrix = pred_mat, seed = 123)

lm_imp <- with(silownia_imp, lm(BMI ~ Weight_kg + Gender))
lm_pooled <- pool(lm_imp)

summary(lm_pooled, conf.int = TRUE, conf.level = 0.95)

stripplot(silownia_imp, BMI ~ Weight_kg | .imp, pch = 20, cex = 2)

silownia_mice <- complete(silownia_imp, action = 1)
```

**3. Imputacja hot-deck**

```{r}
silownia_hotdeck <- hotdeck(silownia)
```

**4. Imputacja RPART**

```{r warning=FALSE}
silownia_rpart  <- silownia  %>%
  mutate(Workout_Type = case_when(
    Workout_Type == "Yoga" ~ 1,
    Workout_Type == "Cardio" ~ 2,
    Workout_Type == "HIIT" ~ 3,
    Workout_Type == "Strength" ~ 4,
    TRUE ~ as.numeric(Workout_Type) 
  ))

silownia_rpart <- silownia_rpart %>%
  mutate(Gender = case_when(
    Gender == "Male" ~ 1,
    Gender == "Female" ~ 2,
    TRUE ~ as.numeric(Gender) 
  ))


drzewo_decyzyjne1 <- rpart(Workout_Type ~ Age + BMI + Max_BPM + Weight_kg + Height_m + Avg_BPM + Resting_BPM + 
                             Session_Duration_hours + Calories_Burned + 
                             Fat_Percentage + Water_Intake_liters + 
                             Workout_Frequency_daysweek + Gender + Experience_Level, data = silownia_rpart, method = "anova", na.action = na.exclude)

silownia_rpart$Workout_Type[is.na(silownia_rpart$Workout_Type)] <- predict(drzewo_decyzyjne1, newdata = silownia_rpart[is.na(silownia_rpart$Workout_Type), ])


drzewo_decyzyjne2 <- rpart(Age ~ BMI + Workout_Type + Gender + Max_BPM + Weight_kg + Height_m + Avg_BPM + Resting_BPM + 
                             Session_Duration_hours + Calories_Burned + 
                             Fat_Percentage + Water_Intake_liters + 
                             Workout_Frequency_daysweek + Experience_Level, data = silownia_rpart, method = "anova", na.action = na.exclude)
silownia_rpart$Age[is.na(silownia_rpart$Age)] <- predict(drzewo_decyzyjne2, newdata = silownia_rpart[is.na(silownia_rpart$Age), ])
```

#### **Wybór metody**

```{r include=FALSE}
silownia_brudne_dane <- silownia_hotdeck
```

Zdecydowaliśmy się zastąpić braki danych występujące w kolumnach *Wiek* i *Typ treningu* za pomocą **metody hot-deck,** ponieważ jest to podejście, które pozwala na imputację brakujących wartości w sposób uwzględniający podobieństwo do istniejących danych. Dzięki tej metodzie wartości brakujące są zastępowane rzeczywistymi danymi z innych obserwacji o podobnych cechach,

## **4. Walidacja danych**

Po zakończeniu procesu uzupełniania braków w naszych danych, kolejnym krokiem w przygotowywaniu ich do dalszej analizy jest ich walidacja. Ten etap pozwala sprawdzić czy dane, są wolne od błędów, niespójności i nieścisłości, które mogłyby negatywnie wpłynąć na dalszą pracę z nimi. Walidacja danych obejmuje zarówno sprawdzenie poprawności logicznej, strukturalnej, jak i identyfikację potencjalnych anomalii czy niezgodności z przyjętymi założeniami.

#### **Wiek**

Wartości w kolumnie *Wiek* powinny być liczbami całkowitymi mieszczącymi się w przedziale od 0 do 110 włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Age <- validator(
  `Age` >= 0,            
  `Age` <= 110,           
  `Age` == floor(Age),
  is.numeric(`Age`) == TRUE
)

cf1 <- confront(silownia_brudne_dane, rules_Age, key="Age")

barplot(cf1, main="")

```

#### **Płeć**

Kolumna *Płeć* przyjmuje wartość Female albo Male.

```{r echo=FALSE, warning=FALSE}
rules_Gender <- validator(Gender %in% c("Female", "Male"))

cf2 <- confront(silownia_brudne_dane, rules_Gender, key="Gender")
barplot(cf2, main="")
```

#### **Waga**

Wartości w kolumnie *Waga* powinny być liczbami mieszczącymi się w przedziale od 40 kg do 140 kg włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Weight_kg <- validator(
  `Weight_kg` >= 40,           
  `Weight_kg` <= 140,
  is.numeric(`Weight_kg`) == TRUE
)

cf3 <- confront(silownia_brudne_dane, rules_Weight_kg, key="Weight_kg")
barplot(cf3, main="")
```

#### **Wzrost**

W kolumnie *Wzrost* powinny znajdować się wartości liczbowe z zakresu od 1.30 m do 2.15 m włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Height_m <- validator(
  `Height_m` >= 1.30,           
  `Height_m` <= 2.15,
  is.numeric(`Height_m`) == TRUE
)
cf4 <- confront(silownia_brudne_dane, rules_Height_m, key="Height_m")
barplot(cf4, main="")

```

#### **Maksymalne tętno**

Kolumna *Maksymalne tętno* musi posiadać wartości, które są liczbami z zakresu od 110 do 210 włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Max_BPM <- validator(
 `Max_BPM` >=110,
 `Max_BPM` <=210,
 is.numeric(`Max_BPM`) == TRUE
)

cf5 <- confront(silownia_brudne_dane, rules_Max_BPM, key="Max_BPM")

barplot(cf5, main="")

```

#### **Średnie tętno**

Wartości w kolumnie *Średnie tętno* powinny być liczbami mieszczącymi się w przedziale od 80 do 180 włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Avg_BPM <- validator(
  `Avg_BPM` >=80,
  `Avg_BPM` <=180,
  is.numeric(`Avg_BPM`) == TRUE
)

cf6 <- confront(silownia_brudne_dane, rules_Avg_BPM, key="Avg_BPM")
barplot(cf6, main="")
```

#### **Spoczynkowe tętno**

W kolumnie *Spoczynkowe tętno* powinny znajdować się wartości liczbowe z zakresu od 45 do 130 włącznie.

```{r echo=FALSE, warning=FALSE}
rules_Resting_BPM <- validator(
  `Resting_BPM` >= 45,
  `Resting_BPM` <=130,
  is.numeric(`Resting_BPM`) == TRUE
)

cf7 <- confront(silownia_brudne_dane, rules_Resting_BPM, key="Resting_BPM")
barplot(cf7, main="")
```

#### **Czas trwania sesji**

Wartości w kolumnie *Czas trwania sesji* powinny być dodatnimi liczbami nieprzekraczającymi 2.

```{r echo=FALSE, warning=FALSE}
rules_Session_Duration_hours <- validator(
  `Session_Duration_hours` > 0, 
  `Session_Duration_hours` <= 2,
  is.numeric(`Session_Duration_hours`) == TRUE
)

cf8 <- confront(silownia_brudne_dane, rules_Session_Duration_hours, key="Session_Duration_hours")
barplot(cf8, main="")

```

#### **Spalone kalorie**

Wartości powinny być dodatnimi liczbami nieprzekraczającymi 2000.

```{r echo=FALSE, warning=FALSE}
rules_Calories_Burned <- validator(
  `Calories_Burned` > 0, 
  `Calories_Burned` <= 2000,
  is.numeric(`Calories_Burned`) == TRUE
)

cf9 <- confront(silownia_brudne_dane, rules_Calories_Burned, key="Calories_Burned")
barplot(cf9, main="")

```

#### **Typ treningu**

Kolumna *Typ treningu* powinna zawierać tylko takie wartości jak: Yoga, Cardio, HIIT oraz Strength.

```{r echo=FALSE, warning=FALSE}
rules_Workout_Type <- validator(Workout_Type %in% c("Yoga", "Cardio", "HIIT","Strength"))


cf10 <- confront(silownia_brudne_dane, rules_Workout_Type, key="Workout_Type")
barplot(cf10, main="")

```

#### **Procent tkanki tłuszczowej**

Wartości w kolumnie *Procent tkanki tłuszczowej* powinny być liczbami dodatnimi nieprzekraczającymi 50.

```{r echo=FALSE, warning=FALSE}
rules_Fat_Percentage <- validator(
  `Fat_Percentage` > 0, 
  `Fat_Percentage` <= 50,
  is.numeric(`Fat_Percentage`) == TRUE
)

cf11 <- confront(silownia_brudne_dane, rules_Fat_Percentage, key="Fat_Percentage")
barplot(cf11, main="")
```

#### **Ilość wypitej wody**

Wartości powinny być liczbami dodatnimi nieprzekraczającymi 4.

```{r echo=FALSE, warning=FALSE}
rules_Water_Intake_liters <- validator(
  `Water_Intake_liters` > 0, 
  `Water_Intake_liters` <= 4,
  is.numeric(`Water_Intake_liters`) == TRUE
)

cf12 <- confront(silownia_brudne_dane, rules_Water_Intake_liters, key="Water_Intake_liters")
barplot(cf12, main="")
```

#### **Częstotliwość treningów**

Kolumna *Częstotliwość treningów* powinna zawierać tylko takie wartości jak: 0, 1, 2, 3, 4, 5, 6, 7.

```{r echo=FALSE, warning=FALSE}
rules_Workout_Frequency_daysweek <- validator(
  Workout_Frequency_daysweek >= 0,
  Workout_Frequency_daysweek <= 7,
  Workout_Frequency_daysweek %% 1 == 0
)

cf13 <- confront(silownia_brudne_dane, rules_Workout_Frequency_daysweek, key="Workout_Frequency_daysweek")
barplot(cf13, main="")

```

#### **Poziom doświadczenia**

Kolumna *Poziom doświadczenia* powinna zawierać tylko takie wartości jak: 0, 1, 2, 3.

```{r echo=FALSE, warning=FALSE}
rules_Experience_Level <- validator(
  Experience_Level >= 0,
  Experience_Level <= 3,
  Experience_Level %% 1 == 0
)

cf14 <- confront(silownia_brudne_dane, rules_Experience_Level, key="Experience_Level")
barplot(cf14, main="")
```

#### **BMI**

Wartości w kolumnie *BMI* powinny być dodatnimi liczbami mieszczącymi się w przedziale od 10 do 60 włącznie, a ich różnica względem wartości obliczonej jako ***Weight_kg/Height_m\^2*** powinna być mniejsza niż 0.1.

```{r echo=FALSE, warning=FALSE}
rules_BMI <- validator(
  `BMI` > 0,                      
  `BMI` >= 10,
  `BMI` <= 60, 
  abs(`BMI` - (`Weight_kg` / (`Height_m`^2))) < 0.1 # 
)

cf15 <- confront(silownia_brudne_dane, rules_BMI, key="BMI")
barplot(cf15, main="")
```

#### **Podsumowanie**

W naszym zbiorze danych nie wystąpiły żadne błędy, więc jest on **gotowy do przeprowadzenia wizualizacji oraz dalszej analizy**.

# **Wizualizacja danych i analiza opisowa**

Po zakończeniu procesu data wranglingu, nasze dane są w pełni oczyszczone, uporządkowane i gotowe do dalszej analizy. Na etapie wizualizacji oraz statystyk opisowych skupimy się na przedstawieniu szerokiego wachlarza analiz, które pozwolą na wydobycie najbardziej wartościowych i interesujących informacji z dostępnych danych. Dzięki zastosowaniu różnorodnych technik wizualizacji, takich jak wykresy, diagramy, czy tabele zidentyfikujemy istotne wzorce, zależności oraz trendy.

### **Rozkład płci**

```{r echo=FALSE, warning=FALSE}
Silownia_wykresy <- silownia_brudne_dane
ggplot(Silownia_wykresy, aes(x = Gender, fill = Gender)) + 
  geom_bar(stat = "count", width = 0.6, color = "black", size = 0.5) +  
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 5) +  # Dodanie wartości na słupkach
  scale_fill_manual(values = c("Male" = "#3498db", "Female" = "#e74c3c")) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, max(table(Silownia_wykresy$Gender)) + 60)) +
  labs(
    title = "Rozkład płci w zbiorze danych", 
    x = "Płeć", 
    y = "Liczba osób"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 0, hjust = 0.5),
    plot.title.position = "panel"
  )

```

Wykres pokazuje równomierny rozkład płci w analizowanym zbiorze danych. Widoczna jest zbliżona liczba kobiet i mężczyzn, z niewielką przewagą mężczyzn, około 500 osób w każdej grupie.

### **Rozkład wieku w zależności od płci**

```{r echo=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(Age, color = Gender, fill = Gender)) +
  geom_density(alpha = 0.5) +
  labs(title = "Rozkład wieku w zależności od płci", x = "Wiek", y = "") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 0, hjust = 0.5),
    plot.title.position = "panel"
  )
```

Wykres przedstawia rozkład wieku w zależności od podanej płci. Zauważyć można większy udział mężczyzn w grupie wiekowej 25-39 lat. Z kolei w grupie 40-55 lat przeważyła płeć żeńska.

### **Statystyki opisowe zmiennej wiek w zależności od płci**

```{r echo=FALSE, warning=FALSE}
opis_Age <- list( "Wiek" = 
                    list(
                      "Min"= ~ min(Age),
                      "Max"= ~ max(Age),
                      "Kwartyl dolny"= ~ quantile(Age,0.25),
                      "Mediana"= ~ round(median(Age),2),
                      "Kwartyl górny"= ~ quantile(Age,0.75),
                      "Średnia"= ~ round(mean(Age),2),
                      "Odch. std."= ~ round(sd(Age),2),
                      "IQR"= ~ round(IQR(Age),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(Age)/2,2),
                      "Odch. std. w %"=~round((sd(Age)/mean(Age)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Age)/median(Age)),2),
                      "Skośność"=~round(skew(Age),2),
                      "Kurtoza"=~round(kurtosi(Age),2)
                    ))
tabela_Age <- summary_table(Silownia_wykresy, summaries = opis_Age, by = c("Gender"), markup = "plain")
tabela_Age <- gsub("~~", "", tabela_Age)
tabela_Age <- as.data.frame(tabela_Age)
tabela_Age <- tabela_Age[-1, ]  

tabela_Age %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "Kobiety", "Mężczyźni"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Płeć" = 2))
```

### **Zależność BMI od wieku**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Age, y = BMI)) +
  geom_point(color = "darkgreen", size = 3, alpha = 0.6) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  xlab("Wiek") +
  ylab("BMI") +
  ggtitle("Zależność BMI od wieku") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Wykres pokazuje, jakie wartości wskaźnika BMI osiągano dla danego wieku. Dodano także linię trendu, która została oszacowana na poziomie BMI = 25.

### **Statystyki opisowe zmiennej BMI w zależności od wieku**

```{r echo=FALSE}
opis_BMI <- list( "BMI" = 
                    list(
                      "Min"= ~ min(BMI),
                      "Max"= ~ round(max(BMI),2),
                      "Kwartyl dolny"= ~ round(quantile(BMI,0.25),2),
                      "Mediana"= ~ round(median(BMI),2),
                      "Kwartyl górny"= ~ round(quantile(BMI,0.75),2),
                      "Średnia"= ~ round(mean(BMI),2),
                      "Odch. std."= ~ round(sd(BMI),2),
                      "IQR"= ~ round(IQR(BMI),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(BMI)/2,2),
                      "Odch. std. w %"=~round((sd(Age)/mean(BMI)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Age)/median(BMI)),2),
                      "Skośność"=~round(skew(BMI),2),
                      "Kurtoza"=~round(kurtosi(BMI),2)
                    ))

Silownia_wykresy$Age_Category <- cut(Silownia_wykresy$Age,
                                     breaks = c(18, 29, 39, 49, 59),
                                     labels = c("18-29", "29-39", "39-49", "49-59"),
                                     right = FALSE)

tabela_BMI <- summary_table(Silownia_wykresy, summaries = opis_BMI, by = c("Age_Category"), markup = "plain")
tabela_BMI <- gsub("~~", "", tabela_BMI)
tabela_BMI <- as.data.frame(tabela_BMI)
tabela_BMI <- tabela_BMI[-1, ] 
tabela_BMI %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "18-29", "29-39", "39-49", "49-59"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Wiek" = 4))
```

Na podstawie powyższych wyników można stwierdzić, że najwyższą średnią wartość BMI osiągnięto dla grupy wiekowej 18-29 lat, dla której największa jest też mediana BMI równa 24,96. Minimalna wartość BMI to 12,32 dla osób w wieku 39-49 lat, a maksymalna wynosi niespełna 50 dla tej samej grupy wiekowej.

W grupie wiekowej 49-59 nastąpiło największe rozproszenie danych. Wyniosło ono 7,1. Rozstęp międzykwartylowy (IQR) osiąga wartości od 7,08 do 9,08, co wskazuje na stabilność w centralnej części rozkładu. Rozkład BMI jest lekko dodatnio skośny. Wartości Bmi większe od średniej są nieco bardziej rozproszone. Wartości kurtozy wskazują na to, że dane są bardziej rozproszone, a wyniki nie wykazują silnej koncentracji wokół średniej ani wielu skrajnych wartości.

### **Rozkład wagi w zależności od płci**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(Weight_kg, color = Gender, fill = Gender)) +
  geom_density(alpha = 0.7) +
  xlab("Waga (kg)") +
  ylab("") +
  ggtitle("Rozkład wagi w zależności od płci") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  ) +
  scale_color_manual(values = c("Male" = "darkblue", "Female" = "pink")) +  # Zmiana kolorów linii
  scale_fill_manual(values = c("Male" = "lightblue", "Female" = "lightpink"))  # Zmiana kolorów wypełnienia

```

Rozkład wagi u kobiet jest bardziej skoncentrowany w przedziale 50–70 kg, co wskazuje na mniejszą zmienność i większą jednolitość w populacji kobiet.

Rozkład wagi u mężczyzn jest szerszy, co oznacza większą zmienność. Wagi mężczyzn najczęściej mieszczą się w przedziale 70–90 kg, ale rozkład ma dłuższy ogon w kierunku wyższych wartości, sięgając ponad 120 kg.

Ogólnie, mężczyźni wykazują większe zróżnicowanie wag w porównaniu do kobiet, z tendencją do wyższych wartości wagi. Rozkłady są symetryczne, z wyraźnymi różnicami między średnimi i zakresami wag dla obu płci.

### **Statystyki opisowe zmiennej wagi w zależności od płci**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_Weight <- list( "Waga" = 
                    list(
                      "Min"= ~ min(Weight_kg),
                      "Max"= ~ max(Weight_kg),
                      "Kwartyl dolny"= ~ quantile(Weight_kg,0.25),
                      "Mediana"= ~ round(median(Weight_kg),2),
                      "Kwartyl górny"= ~ quantile(Weight_kg,0.75),
                      "Średnia"= ~ round(mean(Weight_kg),2),
                      "Odch. std."= ~ round(sd(Weight_kg),2),
                      "IQR"= ~ round(IQR(Weight_kg),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(Weight_kg)/2,2),
                      "Odch. std. w %"=~round((sd(Weight_kg)/mean(Weight_kg)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Weight_kg)/median(Weight_kg)),2),
                      "Skośność"=~round(skew(Weight_kg),2),
                      "Kurtoza"=~round(kurtosi(Weight_kg),2)
                    ))
tabela_Weight <- summary_table(Silownia_wykresy, summaries = opis_Weight, by = c("Gender"), markup = "plain")
tabela_Weight <- gsub("~~", "", tabela_Weight)
tabela_Weight <- as.data.frame(tabela_Weight)
tabela_Weight <- tabela_Weight[-1, ]  

tabela_Weight %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "Kobiety", "Mężczyźni"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Płeć" = 2))
```

Waga kobiet waha się od 40 do 79,9 kg. Mediana wynosi 61,35 kg, a średnia 60,94 kg, co wskazuje na zbliżone wartości centralne. Rozstęp międzykwartylowy (IQR) wynosi 15,13, a odchylenie standardowe 10,24, co wskazuje na umiarkowaną zmienność wagi w tej grupie. Skośność (-0,16) wskazuje na lekko ujemny rozkład, co oznacza, że częściej występują wyższe wartości wagi, a kurtoza (-0,81) sugeruje spłaszczony rozkład.

Waga mężczyzn jest bardziej zróżnicowana i waha się od 45 do 129,9 kg. Mediana wynosi 85,3 kg, a średnia 85,53 kg, co oznacza, że większość wartości oscyluje wokół tego przedziału. Rozstęp międzykwartylowy (IQR) wynosi 31,85, a odchylenie standardowe 21,79, co wskazuje na większe zróżnicowanie wagi niż w przypadku kobiet. Skośność (0,15) sugeruje lekko dodatni rozkład, co oznacza, że częściej występują niższe wartości wagi, a kurtoza (-0,73) również wskazuje na spłaszczony rozkład.

Podsumowując, kobiety mają mniejsze zróżnicowanie wagi w porównaniu do mężczyzn, których wagi rozkładają się na szerszym przedziale. Mediana i średnia wagi są wyższe u mężczyzn. Rozkłady w obu grupach są lekko spłaszczone, ale różnią się kierunkiem skośności.

### **Czas trwania sesji a spalone kalorie**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Session_Duration_hours, y = Calories_Burned)) +
  geom_point(color = "blue", size = 3, alpha = 0.7) +
  geom_smooth(method = "loess", color = "orange", se = TRUE) +
  xlab("Czas trwania sesji (godziny)") +
  ylab("Spalone kalorie") +
  ggtitle("Czas trwania sesji a spalone kalorie") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )

```

### **Statystyki opisowe dla spalonych kalorii w zależności od długości trwania sesji treningowej**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_Calories_Burned <- list( "Spalone kalorie" = 
                    list(
                      "Min"= ~ min(Calories_Burned),
                      "Max"= ~ max(Calories_Burned),
                      "Kwartyl dolny"= ~ quantile(Calories_Burned,0.25),
                      "Mediana"= ~ round(median(Calories_Burned),2),
                      "Kwartyl górny"= ~ quantile(Calories_Burned,0.75),
                      "Średnia"= ~ round(mean(Calories_Burned),2),
                      "Odch. std."= ~ round(sd(Calories_Burned),2),
                      "IQR"= ~ round(IQR(Calories_Burned),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(Calories_Burned)/2,2),
                      "Odch. std. w %"=~round((sd(Calories_Burned)/mean(Calories_Burned)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Calories_Burned)/median(Calories_Burned)),2),
                      "Skośność"=~round(skew(Calories_Burned),2),
                      "Kurtoza"=~round(kurtosi(Calories_Burned),2)
                    ))

Silownia_wykresy$Duration_Category <- cut(Silownia_wykresy$Session_Duration_hours, 
                                          breaks = c(0, 1, 1.5, 2), 
                                          labels = c("0,5-1h", "1-1,5h", "1,5-2h"), 
                                          right = FALSE)

tabela_Calories_Burned <- summary_table(Silownia_wykresy, summaries = opis_Calories_Burned, by = c("Duration_Category"), markup = "plain")
tabela_Calories_Burned <- gsub("~~", "", tabela_Calories_Burned)
tabela_Calories_Burned <- as.data.frame(tabela_Calories_Burned)
tabela_Calories_Burned <- tabela_Calories_Burned[-1, ]  

tabela_Calories_Burned %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "0,5-1h", "1-1,5h", "1,5-2h"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Czas trwania sesji" = 3))
```

0,5–1 godz.: Liczba spalonych kalorii waha się od 303 do 832, z medianą 534,5 i średnią 540,77. Rozstęp międzykwartylowy (IQR) wynosi 186, co wskazuje na umiarkowaną zmienność w centralnej części rozkładu. Odchylenie standardowe wynosi 115,7, co oznacza niewielkie zróżnicowanie wartości. Rozkład jest lekko dodatnio skośny (0,18), co oznacza, że wartości wyższe od średniej pojawiają się rzadziej.

1–1,5 godz.: Liczba spalonych kalorii wzrasta, waha się od 576 do 1385, z medianą 888 i średnią 902,47. Rozstęp międzykwartylowy (IQR) wynosi 212,5, co oznacza większą zmienność niż w poprzedniej kategorii. Odchylenie standardowe to 150,64, co wskazuje na większe zróżnicowanie wyników. Skośność (0,32) jest nieco wyższa, co wskazuje na większą asymetrię w kierunku wyższych wartości.

1,5–2 godz.: Liczba spalonych kalorii jest najwyższa, od 837 do 1783, z medianą 1240 i średnią 1258,46. Rozstęp międzykwartylowy (IQR) wynosi 238,5, a odchylenie standardowe 187,41, co wskazuje na największą zmienność w tej grupie. Skośność (0,34) jest podobna do poprzedniej grupy, sugerując asymetrię w kierunku wyższych wartości.

Podsumowując, wraz ze wzrostem czasu trwania sesji rośnie liczba spalonych kalorii, zarówno pod względem wartości minimalnych, średnich, jak i maksymalnych. Jednocześnie wzrasta zmienność wyników (odchylenie standardowe i IQR), co sugeruje, że dłuższe sesje treningowe prowadzą do bardziej zróżnicowanych rezultatów w spalaniu kalorii. Rozkład w każdej kategorii jest lekko dodatnio skośny, z tendencją do większego spłaszczenia w miarę wydłużania sesji (kurtoza od -0,77 do -0,14).

### **Spalone kalorie a waga**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Weight_kg, y = Calories_Burned)) +
  geom_point(color = "purple", size = 3, alpha = 0.6) +
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  xlab("Waga (kg)") +
  ylab("Spalone kalorie") +
  ggtitle("Spalone kalorie a waga") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Wykres przedstawia zależność między wagą a liczbą spalonych kalorii. Punkty danych pokazują dużą zmienność w liczbie spalonych kalorii wśród osób o podobnej wadze, jednak trend zaznaczony linią regresji sugeruje niewielką dodatnią korelację. Oznacza to, że osoby o wyższej wadze generalnie spalają więcej kalorii, choć zależność ta jest słaba. Rozrzut punktów wskazuje, że na liczbę spalonych kalorii mogą wpływać także inne czynniki, takie jak intensywność i rodzaj treningu.

### **Średnia liczba spalonych kalorii dla różnych typów treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Workout_Type, y = Calories_Burned, fill = Workout_Type)) +
  stat_summary(fun = "mean", geom = "bar") +
  labs(title = "Średnia liczba spalonych kalorii dla różnych typów treningu", x = "Typ treningu", y = "Średnie spalone kalorie") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Wykres pokazuje, że średnia liczba spalonych kalorii jest zbliżona dla wszystkich rodzajów treningów, przy czym HIIT i trening siłowy spalają nieco więcej kalorii niż joga i cardio.

### **Średnie spalone kalorie według płci i poziomu doświadczenia**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = factor(Experience_Level), y = Calories_Burned, fill = Gender)) +
  stat_summary(fun = "mean", geom = "bar", position = "dodge") +
  labs(title = "Średnie spalone kalorie według płci i poziomu doświadczenia", x = "Poziom doświadczenia", y = "Średnie spalone kalorie") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Wykres przedstawia średnią liczbę spalonych kalorii w zależności od poziomu doświadczenia i płci. Wraz ze wzrostem poziomu doświadczenia (od 1 do 3) rośnie średnia liczba spalonych kalorii dla obu płci.

Mężczyźni spalają nieco więcej kalorii niż kobiety na każdym poziomie doświadczenia, przy czym różnica ta pozostaje niewielka. Na poziomie doświadczenia 3 różnica jest najbardziej widoczna, co może wskazywać na większą intensywność lub efektywność treningu u bardziej doświadczonych mężczyzn. Ogólnie trend pokazuje, że większe doświadczenie wiąże się z większą liczbą spalonych kalorii, niezależnie od płci.

### **Średnie tętno dla różnych typów treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Workout_Type, y = Avg_BPM, fill = Workout_Type)) +
  geom_boxplot(alpha = 0.7) +
  xlab("Rodzaj treningu") +
  ylab("Średnie tętno (BPM)") +
  ggtitle("Średnie tętno a rodzaj treningu") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )

```

### **Statystyki opisowe dla średniego tętna w zależności od typu treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_AvgBPM_WorkoutType <- list( "Średnie tętno" = 
                    list(
                      "Min"= ~ min(Avg_BPM),
                      "Max"= ~ max(Avg_BPM),
                      "Kwartyl dolny"= ~ quantile(Avg_BPM,0.25),
                      "Mediana"= ~ round(median(Avg_BPM),2),
                      "Kwartyl górny"= ~ quantile(Avg_BPM,0.75),
                      "Średnia"= ~ round(mean(Avg_BPM),2),
                      "Odch. std."= ~ round(sd(Avg_BPM),2),
                      "IQR"= ~ round(IQR(Avg_BPM),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(Avg_BPM)/2,2),
                      "Odch. std. w %"=~round((sd(Avg_BPM)/mean(Avg_BPM)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Avg_BPM)/median(Avg_BPM)),2),
                      "Skośność"=~round(skew(Avg_BPM),2),
                      "Kurtoza"=~round(kurtosi(Avg_BPM),2)
                    ))

tabela_AvgBPM_WorkoutType <- summary_table(Silownia_wykresy, summaries = opis_AvgBPM_WorkoutType, by = c("Workout_Type"), markup = "plain")
tabela_AvgBPM_WorkoutType <- gsub("~~", "", tabela_AvgBPM_WorkoutType)
tabela_AvgBPM_WorkoutType <- as.data.frame(tabela_AvgBPM_WorkoutType)
tabela_AvgBPM_WorkoutType <- tabela_AvgBPM_WorkoutType[-1, ]  

tabela_AvgBPM_WorkoutType %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "Yoga", "Cardio", "HIIT", "Trening siłowy"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Rodzaj treningu" = 4))
```

Wyniki pokazują, że średnie tętno w różnych rodzajach treningów (joga, cardio, HIIT, trening siłowy) jest bardzo zbliżone. Średnie wartości oscylują wokół 144 uderzeń na minutę, z minimalną i maksymalną wartością wynoszącą 120 i 169. Mediana jest najwyższa w jodze i treningu siłowym (144), nieco niższa w HIIT (143) i cardio (142). Rozproszenie danych, mierzone odchyleniem standardowym, jest również podobne, wynosząc około 14, co wskazuje na umiarkowaną zmienność w każdej grupie.

Rozstęp międzykwartylowy (IQR) wynosi około 25 we wszystkich przypadkach, co potwierdza stabilność w centralnej części rozkładu. Rozkład danych jest niemal symetryczny (skośność bliska 0) i lekko spłaszczony (kurtoza od -1.21 do -1.27), co oznacza mniejszą liczbę wartości skrajnych w porównaniu do rozkładu normalnego. Ogólnie, wyniki wskazują na podobną intensywność treningową dla wszystkich analizowanych aktywności w kontekście tętna.

### **Zależność tętna spoczynkowego od wieku**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Age, y = Resting_BPM)) +
  geom_point(color = "orange", size = 3, alpha = 0.6) +
  geom_smooth(method = "loess", color = "blue", se = TRUE) +
  xlab("Wiek") +
  ylab("Tętno spoczynkowe (BPM)") +
  ggtitle("Zależność tętna spoczynkowego od wieku") +
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Do wykresu wstawiono linię trendu wygładzoną, co pozwoliło uchwycić nieliniowe zależności między zmiennymi. Cień to przedział ufności, który wskazuje niepewność estymacji linii trendu. Szeroki cień oznacza większą niepewność w przewidywaniu. Wykres przedstawia zależność tętna spoczynkowego od wieku. Punkty na wykresie pokazują dużą zmienność indywidualnych wartości, jednak trend zaznaczony linią regresji wskazuje, że tętno spoczynkowe lekko spada do około 40. roku życia, a następnie nieznacznie wzrasta. Ogólnie, tętno spoczynkowe utrzymuje się w stabilnym przedziale 60–70 BPM, niezależnie od wieku, co sugeruje brak istotnych zmian w zależności od wieku u większości osób.

### **Statystyki opisowe dla tętna spoczynkowego w zależności od wieku**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_RestingBPM_Age <- list( "Tętno spoczynkowe" = 
                                list(
                                  "Min"= ~ min(Resting_BPM),
                                  "Max"= ~ max(Resting_BPM),
                                  "Kwartyl dolny"= ~ quantile(Resting_BPM,0.25),
                                  "Mediana"= ~ round(median(Resting_BPM),2),
                                  "Kwartyl górny"= ~ quantile(Resting_BPM,0.75),
                                  "Średnia"= ~ round(mean(Resting_BPM),2),
                                  "Odch. std."= ~ round(sd(Resting_BPM),2),
                                  "IQR"= ~ round(IQR(Resting_BPM),2),
                                  "Odchylenie ćwiartkowe"=~round(IQR(Resting_BPM)/2,2),
                                  "Odch. std. w %"=~round((sd(Resting_BPM)/mean(Resting_BPM)),2),
                                  "Odch. ćwiartkowe w %"=~round((IQR(Resting_BPM)/median(Resting_BPM)),2),
                                  "Skośność"=~round(skew(Resting_BPM),2),
                                  "Kurtoza"=~round(kurtosi(Resting_BPM),2)
                                ))

Silownia_wykresy$Age_Category <- cut(Silownia_wykresy$Age, 
                                          breaks = c(0, 30, 50, 70), 
                                          labels = c("<30 lat", "30-50 lat", ">50 lat"), 
                                          right = FALSE)

tabela_RestingBPM_Age <- summary_table(Silownia_wykresy, summaries = opis_RestingBPM_Age, by = c("Age_Category"), markup = "plain")
tabela_RestingBPM_Age <- gsub("~~", "", tabela_RestingBPM_Age)
tabela_RestingBPM_Age <- as.data.frame(tabela_RestingBPM_Age)
tabela_RestingBPM_Age <- tabela_RestingBPM_Age[-1, ]  
tabela_RestingBPM_Age %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "<30 lat", "30-50 lat", ">50 lat"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Wiek" = 3))
```

Wyniki pokazują, że tętno spoczynkowe w zależności od grupy wiekowej (\<30 lat, 30-50 lat, \>50 lat) jest stabilne, z niewielkimi różnicami w średnich wartościach: 62,44 dla osób młodszych, 62,1 dla grupy średniej i 62,18 dla osób starszych. Wartości minimalne i maksymalne (50 i 74) są identyczne we wszystkich grupach, co wskazuje na spójność w zakresie danych.

Mediana wynosi 62 lub 63, co sugeruje, że tętno większości osób oscyluje w tym przedziale. Rozstęp międzykwartylowy (IQR) i odchylenie ćwiartkowe są zbliżone (odpowiednio 12–13 i 6–6,5), co świadczy o porównywalnej zmienności w każdej grupie wiekowej.

Rozkład danych jest lekko ujemnie skośny (-0,06 do -0,1), co oznacza, że wartości niższe od średniej są nieco częstsze, a kurtoza (od -1,2 do -1,23) sugeruje spłaszczony rozkład, co wskazuje na mniejszą liczbę wartości ekstremalnych. Ogólnie wyniki pokazują, że wiek ma niewielki wpływ na tętno spoczynkowe.

### **Czas trwania sesji w zależności od typu treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Workout_Type, y = Session_Duration_hours, fill = Workout_Type)) +
  geom_violin() +
  labs(title = "Czas trwania sesji w zależności od typu treningu", x = "Typ treningu", y = "Czas trwania (godziny)") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )
```

Wykres wiolinowy przedstawia rozkład czasu trwania sesji w zależności od rodzaju treningu (joga, cardio, HIIT, trening siłowy).

Największa zmienność czasu trwania widoczna jest w treningu siłowym i HIIT, gdzie czas trwania sesji jest bardziej zróżnicowany, a wartości rozkładają się szeroko w zakresie od około 0,5 do 2 godzin. Joga i cardio charakteryzują się bardziej skoncentrowanym czasem trwania sesji, ze szczytem w okolicach 1–1,5 godziny.

Średni czas trwania treningu dla wszystkich rodzajów treningów oscyluje wokół podobnych wartości, jednak rozkłady pokazują, że joga i cardio mają mniej skrajnych wartości w porównaniu do HIIT i treningu siłowego.

### **Statystyki opisowe dla trwania sesji w zależności od typu treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_SessionDuration_WorkoutType <- list( "Czas trwania sesji" = 
                               list(
                                 "Min"= ~ min(Session_Duration_hours),
                                 "Max"= ~ max(Session_Duration_hours),
                                 "Kwartyl dolny"= ~ quantile(Session_Duration_hours,0.25),
                                 "Mediana"= ~ round(median(Session_Duration_hours),2),
                                 "Kwartyl górny"= ~ quantile(Session_Duration_hours,0.75),
                                 "Średnia"= ~ round(mean(Session_Duration_hours),2),
                                 "Odch. std."= ~ round(sd(Session_Duration_hours),2),
                                 "IQR"= ~ round(IQR(Session_Duration_hours),2),
                                 "Odchylenie ćwiartkowe"=~round(IQR(Session_Duration_hours)/2,2),
                                 "Odch. std. w %"=~round((sd(Session_Duration_hours)/mean(Session_Duration_hours)),2),
                                 "Odch. ćwiartkowe w %"=~round((IQR(Session_Duration_hours)/median(Session_Duration_hours)),2),
                                 "Skośność"=~round(skew(Session_Duration_hours),2),
                                 "Kurtoza"=~round(kurtosi(Session_Duration_hours),2)
                               ))

tabela_SessionDuration_WorkoutType <- summary_table(Silownia_wykresy, summaries = opis_SessionDuration_WorkoutType, by = c("Workout_Type"), markup = "plain")
tabela_SessionDuration_WorkoutType <- gsub("~~", "", tabela_SessionDuration_WorkoutType)
tabela_SessionDuration_WorkoutType <- as.data.frame(tabela_SessionDuration_WorkoutType)
tabela_SessionDuration_WorkoutType <- tabela_SessionDuration_WorkoutType[-1, ]  

tabela_SessionDuration_WorkoutType %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "Yoga", "Cardio", "HIIT", "Trening siłowy"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Typ treningu" = 4))
```

Wyniki pokazują, że czas trwania sesji treningowych jest zbliżony dla wszystkich typów treningów (joga, cardio, HIIT, trening siłowy). Minimalny czas trwania wynosi około 0,5 godziny, a maksymalny blisko 2 godzin. Średni czas trwania oscyluje między 1,23 godziny (cardio) a 1,28 godziny (joga i HIIT), co jest zbliżone do median, które również wynoszą od 1,23 do 1,29 godziny.

Rozstęp międzykwartylowy (IQR) wynosi od 0,39 (cardio) do 0,42 (joga i HIIT), co wskazuje na podobny zakres w centralnej części rozkładu. Odchylenie standardowe jest również porównywalne (od 0,33 do 0,36), co świadczy o niewielkiej zmienności czasu trwania sesji w każdej grupie. Rozkład danych jest niemal symetryczny (skośność bliska 0), a kurtoza wskazuje na lekko spłaszczony rozkład (od -0,55 do -0,25). Ogólnie, wyniki sugerują, że wszystkie typy treningów mają podobny czas trwania sesji, z niewielkimi różnicami w zmienności i kształcie rozkładu.

### **Częstotliwość treningów a czas trwania sesji**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Workout_Frequency_daysweek, y = Session_Duration_hours, color = Experience_Level)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Częstotliwość treningów a czas trwania sesji", x = "Liczba sesji w tygodniu", y = "Czas trwania sesji (godziny)") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )

```

Wykres przedstawia zależność między liczbą sesji treningowych w tygodniu a czasem trwania pojedynczej sesji, uwzględniając poziom doświadczenia uczestników.

Wraz ze wzrostem liczby sesji w tygodniu obserwuje się tendencję do wydłużania czasu trwania pojedynczej sesji, co wskazuje na większe zaangażowanie w trening przy częstszej aktywności. Linia regresji podkreśla dodatnią korelację między tymi zmiennymi.

Kolor punktów, odpowiadający poziomowi doświadczenia, wskazuje, że osoby bardziej doświadczone (jaśniejsze punkty) częściej wykonują dłuższe sesje i trenują więcej razy w tygodniu. Wynika z tego, że zarówno liczba sesji, jak i czas ich trwania rosną wraz z doświadczeniem.

### **Procent tkanki tłuszczowej ciała a częstotliwość treningów**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Workout_Frequency_daysweek, y = Fat_Percentage)) +
  geom_point(color = "pink", size = 3, alpha = 0.6) +
  geom_smooth(method = "lm", color = "darkorange", se = FALSE) +
  xlab("Częstotliwość treningów (dni/tydzień)") +
  ylab("Procent tkanki tłuszczowej ciała (%)") +
  ggtitle("Zależność między procentem tłuszczu a częstotliwością treningów") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )

```

Powyższy wykres obrazuje zależności procentu tkanki tłuszczowej od częstotliwości treningów. Zależność jest odwrotnie proporcjonalna - im więcej treningów, tym mniejsza tkanka tłuszczowa działa.

### **Statystyki opisowe dla procentu tkanki tłusczowej w zależności od częstotliwość treningów**

```{r echo=FALSE, message=FALSE, warning=FALSE}
opis_Fat_Percentage <- list( "Fat_Percentage" = 
                    list(
                      "Min"= ~ min(Fat_Percentage),
                      "Max"= ~ max(Fat_Percentage),
                      "Kwartyl dolny"= ~ quantile(Fat_Percentage,0.25),
                      "Mediana"= ~ round(median(Fat_Percentage),2),
                      "Kwartyl górny"= ~ quantile(Fat_Percentage,0.75),
                      "Średnia"= ~ round(mean(Fat_Percentage),2),
                      "Odch. std."= ~ round(sd(Fat_Percentage),2),
                      "IQR"= ~ round(IQR(Fat_Percentage),2),
                      "Odchylenie ćwiartkowe"=~round(IQR(Fat_Percentage)/2,2),
                      "Odch. std. w %"=~round((sd(Age)/mean(Fat_Percentage)),2),
                      "Odch. ćwiartkowe w %"=~round((IQR(Age)/median(Fat_Percentage)),2),
                      "Skośność"=~round(skew(Fat_Percentage),2),
                      "Kurtoza"=~round(kurtosi(Fat_Percentage),2)
                    ))

tabela_Fat_Percentage <- summary_table(Silownia_wykresy, summaries = opis_Fat_Percentage, by = c("Workout_Frequency_daysweek"), markup = "plain")
tabela_Fat_Percentage <- gsub("~~", "", tabela_Fat_Percentage)
tabela_Fat_Percentage <- as.data.frame(tabela_Fat_Percentage)
tabela_Fat_Percentage <- tabela_Fat_Percentage[-1, ] 


tabela_Fat_Percentage %>%
  knitr::kable(
    digits = 2,
    align = "lcc", 
    col.names = c("Statystyka", "2", "3", "4", "5"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Częstotliwość treningów" = 4))

```

Na podstawie uzyskanych wyników można stwierdzić, że wraz ze wzrostem częstotliwości treningów spada wartość minimalna i maksymalna procentu tkanki tłuszczowej. Mediana oraz średnia wartość jest zdecydowanie najmniejsza dla częstotliwości treningów wynoszącej 5 dni w tygodniu. Dla 5 dni najmniejsze są też: odchylenie standardowe oraz wartości kwartyli, co pokazuje, jak zostały pogrupowane wartości uzyskane dla tkanki tłuszczowej. Wartości skośności są bliskie zeru, co wskazuje lekką asymetryczność. Występuje zarówno lewostronna (dla 3 i 4 dni w tygodniu), jak i prawostronna (2 i 5) asymetria.

### **Zależnność BMI od wieku oraz typu treningu**

```{r echo=FALSE, message=FALSE, warning=FALSE}
p1 <- ggplot(Silownia_wykresy, aes(x = Age, y = BMI, color = Workout_Type)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE) +
  xlab("Wiek") +
  ylab("BMI") +
  scale_color_discrete(name = "Rodzaj treningu") +
  ggtitle("Zależność BMI od wieku") +
  theme_light()

plotly::ggplotly(p1)
```

### **Histogramy**

#### **Maksymalne tętno**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Max_BPM)) +
  geom_histogram(binwidth = 10, 
                 fill = "skyblue", 
                 color = "black", 
                 alpha = 0.7) +
  ggtitle("Histogram dla Max_BPM") +
  xlab("Maksymalne BPM") +
  ylab("Liczba obserwacji") +
  theme_minimal() +  
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),  
    axis.title = element_text(size = 14),  
    axis.text = element_text(size = 12),  
    panel.grid.major = element_line(color = "gray80", linetype = "dotted")  
  ) +
  scale_x_continuous(breaks = seq(min(Silownia_wykresy$Max_BPM), max(Silownia_wykresy$Max_BPM), by = 20)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))

```

Histogram wskazuje, że większość maksymalnych wartości tętna w badanej próbie mieści się w przedziale 165-195 BPM, co oznacza skupienie wyników w umiarkowanym zakresie tętna maksymalnego. Rozkład sugeruje, że wartości spoza tego przedziału są znacznie rzadsze.

#### **Średnie tętno**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Avg_BPM)) +
  geom_histogram(binwidth = 10, 
                 fill = "lightgreen", 
                 color = "black", 
                 alpha = 0.7) +
  ggtitle("Histogram dla Avg_BPM") +
  xlab("Średnie BPM") +
  ylab("Liczba obserwacji") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12),
    panel.grid.major = element_line(color = "gray80", linetype = "dotted")
  ) +
  scale_x_continuous(breaks = seq(min(Silownia_wykresy$Avg_BPM), max(Silownia_wykresy$Avg_BPM), by = 20)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))

```

Histogram pokazuje, że większość średnich wartości tętna w badanej próbie mieści się w przedziale 125-135 BPM, licząc niemalże 225 obserwacji. . Rozkład wskazuje na skupienie wyników w umiarkowanym zakresie tętna średniego z lekkim odchyleniem w lewą stronę.

#### **Spoczynkowe tętno**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(Silownia_wykresy, aes(x = Resting_BPM)) +
  geom_histogram(binwidth = 5, 
                 fill = "salmon", 
                 color = "black", 
                 alpha = 0.7) +
  ggtitle("Histogram dla Resting_BPM") +
  xlab("Spoczynkowe BPM") +
  ylab("Liczba obserwacji") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12),
    panel.grid.major = element_line(color = "gray80", linetype = "dotted")
  ) +
  scale_x_continuous(breaks = seq(min(Silownia_wykresy$Resting_BPM), max(Silownia_wykresy$Resting_BPM), by = 10)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))

```

Histogram pokazuje, że spoczynkowe wartości tętna w badanej próbie najczęściej mieszczą się w przedziale 57,5-67,5 BPM. Wyniki te wskazują na dominację umiarkowanego zakresu tętna spoczynkowego w analizowanej grupie.

# **Wnioskowanie**

Kolejnym, a zarazem ostatnim etapem naszej analizy będzie wnioskowanie statystyczne, oparte na przeprowadzaniu różnorodnych testów statystycznych oraz dogłębnej analizie zależności między zmiennymi. Proces ten umożliwi formułowanie uogólnionych wniosków na temat całej populacji, bazując na wynikach uzyskanych z dostępnej próby danych. Dzięki zastosowaniu odpowiednich metod statystycznych możliwe będzie nie tylko identyfikowanie istotnych różnic i korelacji, ale również weryfikacja hipotez badawczych, co przyczyni się do lepszego zrozumienia badanych zjawisk i ich kontekstu.

### **Porównanie spalonych kalorii w zależności od poziomu doświadczenia**

#### **Sprawdzenie normalności danych - Test Shapiro-Wilka**

```{r echo=FALSE}
shapiro.test(Silownia_wykresy$Calories_Burned)
```

Z uwagi na wartość p mniejszą od 0.05 można uznać, że dane spełniają założenia normalności i w związku z tym wykorzystać test ANOVA.

Poniższy test (ANOVA) analizuje różnice w średnich liczbach spalonych kalorii pomiędzy grupami na różnych poziomach doświadczenia. Zakłada normalność rozkładu i jednorodność wariancji, a jeśli wynik jest istotny statystycznie, oznacza, że przynajmniej jedna grupa różni się od innych pod względem średniej. Wykorzystuje również korekcję Bonferroniego dla porównań parami, aby kontrolować ryzyko błędu I rodzaju. Hipoteza zerowa zakłada, że nie ma istotnych staystycznie różnic między średnią liczbą spalonych kalorii w zalezności od poziomu doświadczenia.

```{r echo=FALSE}
ggbetweenstats(
  data = Silownia_wykresy,
  x = Experience_Level,
  y = Calories_Burned,
  type = "parametric", # Test parametryczny (ANOVA)
  pairwise.comparisons = TRUE, # Porównania parami
  p.adjust.method = "bonferroni", # Korekcja wielokrotnych porównań
  title = "Różnice w spalonych kaloriach w zależności od poziomu doświadczenia"
)
```

Ogólny wynik testu ANOVA informuje, że wartość p jest ekstremalnie mała (znacznie poniżej typowego poziomu istotności 0,05), co oznacza, że różnice między średnimi spalonych kalorii na różnych poziomach doświadczenia są istotne statystycznie. Również wszystkie różnice między grupami są istotne statystycznie, co oznacza, że każdy poziom doświadczenia różni się istotnie od pozostałych pod względem średniej liczby spalonych kalorii.

Wyniki średnich spalanych kalorii dla każdego z poziomów doświdaczenia pokazują, że średnia liczba spalonych kalorii rośnie wraz z poziomem doświadczenia. Eksperci spalają znacznie więcej kalorii niż średniozaawansowani i początkujący. Efekt poziomu doświadczenia na spalone kalorie jest bardzo silny - 66% wariancji w spalonych kaloriach można wyjaśnić poziomem doświadczenia, co oznacza bardzo silny efekt.

### **Różnice między płciami w preferencjach typów treningów**

Poniższy test przeprowadza analizę proporcji danych kategorycznych, jakimi jest typ treningu w zależności od płci. Wykorzystuje test Chi-kwadrat, aby sprawdzić, czy rozkład kategorii różni się istotnie między grupami. Wizualizacja w formie wykresu kołowego przedstawia proporcje w każdej kategorii z wynikami testów statystycznych.

```{r echo=FALSE}
ggpiestats(
  data = Silownia_wykresy,
  x = Workout_Type,
  y = Gender,
  title = "Rozkład typów treningów w zależności od płci"
)
```

Hipoteza zerowa zakłada, że rozkład typów treningów jest taki sam dla kobiet i mężczyzn. Wartość p jest większa od typowego poziomu istotności 0,05, co oznacza, że nie ma podstaw do odrzucenia hipotezy zerowej.

Wartość V Cramera równa 0,01 wskazuje na bardzo słaby efekt wielkości różnic między grupami. Proporcje typów treningów (Yoga, Cardio, Strength, HIIT) są bardzo zbliżone między kobietami i mężczyznami: Dla kobiet: Yoga (27%), Cardio (28%), Strength (22%), HIIT (23%). Dla mężczyzn: Yoga (27%), Cardio (25%), Strength (25%), HIIT (23%).

Podsumowując, można zauważyć brak istotnych różnic w preferencjach typów treningów między kobietami a mężczyznami. Proporcje typów treningów są praktycznie takie same w obu grupach, co potwierdza zarówno wynik statystyczny, jak i wizualizacja.

### **Badanie zależności spalonych kalorii od czasu trwania sesji treningowej**

Kolejny z opisywanych testów przeprowadza analizę zależności między dwoma zmiennymi ilościowymi, jakimi są: spalone kalorie i czas trwania sesji treningowej. Do analizy wykorzystano korelację Pearsona oraz przedstawioną na wykresie regresję liniową.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggscatterstats(
  data = Silownia_wykresy,
  x = Session_Duration_hours,
  y = Calories_Burned,
  title = "Badanie zależności spalonych kalorii od czasu trwania sesji treningowej"
)
```

Współczynnik korelacji wyniósł 0,91, co wskazuje na bardzo silny dodatni związek między czasem trwania sesji a liczbą spalonych kalorii. Oznacza to, że dłuższe sesje treningowe prowadzą do większej liczby spalonych kalorii, co jest potwierdzeniem wniosków wyciągniętych na podstawie analizy statystyk opisowych. Wartość p = 0,00 sugeruje, iż zależność jest istotna statystycznie, a więc odrzucamy hipotezę zerową mówiącą o braku korelacji między zmiennymi. Statystyka testu t-studenta 67,59 (z liczbą swobody równą 973 i wartością p = 0,00) potwierdza, że współczynnik korelacji różni się istotnie od zera, co dodatkowo wskazuje na wyraźny związek między zmiennymi.

Wartość statystyki Pearsona wynosząca 0,91 pokazuje, że ok. 91% zmienności w liczbie spalonych kalorii można wyjaśnić czasem trwania sesji. Punktowy wykres rozrzutu pokazuje pozytywną zależność między zmiennymi. Punkty układają się blisko linii regresji, a więc dopasowalność modelu liniowego można określić jako dobrą.

Podsumowując, zależność między czasem trwania sesji treningowej a liczbą spalonych kalorii jest bardzo silna i istotna statystycznie. Dłuższe treningi prowadzą do spalenia większej liczby kalorii. Model liniowy dobrze opisuje tę zależność, co sugeruje, że czas trwania sesji jest jednym z kluczowych czynników wpływających na liczbę spalonych kalorii.

### **Różnice między wiekiem w osiąganym tętnie spoczynkowym**

Test ten bada, czy istnieją istotne różnice w proporcjach BPM (BPM_Category) w zależności od grup wiekowych (Age_Category). Zarówno wartości tętna spoczynkowego jak i lata zostały zaprezentowane w przedziałach, aby lepiej zobrazować analizowane zjawisko.

To kolejny test, który wykorzystuje test Chi-kwadrat w celu weryfikacji, czy rozkład kategorii różni się istotnie między grupami. Wizualizacja w formie wykresu słupkowego przedstawia proporcje w każdej kategorii z wynikami testów statystycznych.

```{r echo=FALSE, message=FALSE, warning=FALSE}
Silownia_wykresy$Age_Category <- cut(Silownia_wykresy$Age,
                                     breaks = c(18, 29, 39, 49, 59),
                                     labels = c("18-29", "29-39", "39-49", "49-59"),
                                     right = FALSE)
Silownia_wykresy$BPM_Category <- cut(
  Silownia_wykresy$Resting_BPM,                   
  breaks = c(50, 56, 62, 68, 74),                  
  labels = c("50-56", "56-62", "62-68", "68-74"), 
  right = FALSE                                   
)
ggbarstats(
  data = Silownia_wykresy,
  x = BPM_Category, 
  y = Age_Category,
  caption = "xxx",
  package = "ggsci",
  palette = "default_igv"
)

```

Wartość p większa od 0.05 (równa 0,61) oznacza, że nie ma istotnych statystycznie różnic w rozkładzie grup wartości spoczynkowego tętna między kategoriami wiekowymi. Współczynnik Cramera na poziomie 0,00 wskazuje na brak efektu wielkości różnic między grupami (relacja między zmiennymi jest bardzo słaba lub znikoma).

Dla każdej kategorii p także osiąga wartości wyższe niż 0,05, co sugeruje brak różnic w proporcjach grup wartości tętna spoczynkowego we wszystkich kategoriach wiekowych. Proporcje poszczególnych grup wartości tętna spoczynkowego w każdej kategorii wiekowej są bardzo podobne, co widać na wykresie słupkowym. Nie ma istotnych statystycznie różnic.

Zarówno globalnie, jak i lokalnie wyniki wskazują na równomierny rozkład. Zakładając hipotezę zerową, że rozkład wartości tętna spoczynkowego jest taki sam dla każdej kategorii wiekowej, nie ma podstaw do odrzucenia tejże hipotezy zerowej.

# **Podsumowanie**

Celem naszego projektu była analiza danych pochodzących ze zbioru *Siłownia*. Proces ten został podzielony na kilka kluczowych etapów, obejmujących: przygotowanie danych (data wrangling), wizualizację danych, opracowanie statystyk opisowych oraz przeprowadzenie wnioskowania statystycznego.

W pierwszej fazie projektu skoncentrowaliśmy się na oczyszczeniu i przygotowaniu danych. Analiza wykazała, że zbiór danych nie zawierał istotnych odchyleń ekstremalnych, jednak zidentyfikowano braki w kolumnach: wiek, typ treningu oraz BMI. Braki w kolumnie BMI zostały uzupełnione za pomocą odpowiedniego wzoru, natomiast brakujące wartości w kolumnach wiek i typ treningu uzupełniono metodą imputacji hot deck. Po przeprowadzeniu tych operacji dokonano walidacji danych, która potwierdziła ich poprawność i brak błędów.

W rozdziale dotyczącym wizualizacji oraz analizy opisowej, czyli w kolejnym ważnym etapie pracy, zostały przedstawione wybrane zależności pomiędzy zmiennymi, które znalazły się w bazie danych. Na wstępie zaprezentowano rozkład płci. Na jego podstawie stwierdzono, że liczba kobiet i mężczyzn jest zbliżona, z niewielką przewagą mężczyzn. Pokazano także rozkład wieku w zależności od płci, z którego wyniknęło, iż w grupie wiekowej 25-39 lat udział mężczyzn był większy. W grupie 40-55 lat z kolei przeważyła płeć żeńska.

Dalszą część wizualizacji rozbudowano o szerszą analizę opisową, którą oparto o takie miary jak: wartość minimalna, wartość maksymalna, kwartyle, mediana, średnia, odchylenie standardowe, odchylenie ćwiartkowe, skośność i kurtoza. Na podstawie wykresu oraz wyników analizy wagi w zależności od płaci stwierdzono, że kobiety miały mniejsze zróżnicowanie wagi w porównaniu do mężczyzn, których wagi rozłożyły się na szerszym przedziale. Mediana i średnia wagi były wyższe u mężczyzn. Rozkłady w obu grupach okazały się lekko spłaszczone, ale różniły się kierunkiem skośności.

Wyniki analizy spalonych kalorii w zależności od długości trwania sesji treningowej wskazały z kolei na to, iż wraz ze wzrostem czasu trwania sesji rośnie liczba spalonych kalorii, zarówno pod względem wartości minimalnych, średnich, jak i maksymalnych. Jednocześnie wzrastała zmienność wyników, co sugerowało, że dłuższe sesje treningowe prowadzą do bardziej zróżnicowanych rezultatów w spalaniu kalorii. Zbadano także zmienne wpływające na poziom spalanych kalorii. Wskazano pierwszy wniosek, że osoby o wyższej wadze generalnie spalają więcej kalorii, choć zależność ta jest słaba. Co więcej, w przypadku spalonych kalorii, średnia ich liczba okazała się zbliżona dla wszystkich rodzajów treningów, przy czym HIIT i trening siłowy prowadziły do spalania nieco więcej kalorii niż joga i cardio. W przypadku wpływu poziomu doświadczenia na spalone kalorie, stwierdzono, że większe doświadczenie wiąże się z większą liczbą spalonych kalorii, niezależnie od płci.

W dalszej analizie zbadano, jak rodzaj treningu wpływa na poziom średniego tętna. Wyniki wskazały na podobną intensywność treningową dla wszystkich analizowanych aktywności w kontekście tętna. Analiza zależności tętna wypoczynkowego od wieku również pokazała brak dużej zmienności - tętno spoczynkowe utrzymywało się w stabilnym przedziale 60–70 BPM, niemalże całkowicie niezależnie od wieku. W kolejnym kroku stwierdzono z kolei, że średni czas trwania treningu dla wszystkich jego rodzajów oscylował wokół podobnych wartości, jednak rozkłady pokazały, że joga i cardio mają mniej skrajnych wartości w porównaniu do HIIT i treningu siłowego. Zweryfikowano także, jak liczba sesji treningowych w tygodniu wpływa czas trwania sesji. Uznano, iż wraz ze wzrostem liczby sesji w tygodniu obserwuje się tendencję do wydłużania czasu trwania pojedynczej sesji. Stwierdzono też, że im więcej treningów, tym niższą przeciętną wartość osiąga tkanka tłuszczowa człowieka. Wraz ze wzrostem częstotliwości treningów spadła wartość minimalna i maksymalna procentu tkanki tłuszczowej.

Na koniec tej części pracy zaprezentowano wizualizacje histogramów dla wartości tętna. Histogram maksymalnego tętna pokazał, że większość maksymalnych wartości tętna w badanej próbie mieści się w przedziale 165-195 BPM, co oznaczało skupienie wyników w umiarkowanym zakresie tętna maksymalnego. Histogram średniego tętna pokazał z kolei, że większość średnich wartości tętna w badanej próbie mieści się w przedziale 125-135 BPM. Rozkład wskazał na skupienie wyników w umiarkowanym zakresie tętna średniego z lekkim odchyleniem w lewą stronę. W przypadku spoczynkowego tętna natomiast stwierdzono, że jego wartości w badanej próbie najczęściej mieszczą się w przedziale 57,5-67,5 BPM. Wyniki te przedstawiły dominację umiarkowanego zakresu tętna spoczynkowego w analizowanej grupie.

W ramach wnioskowania statystycznego przeprowadzono testy, które pozwoliły zbadać zależności między zmiennymi i wyciągnąć uogólnione wnioski dotyczące całej populacji. Wyniki analizy wykazały, że średnia liczba spalonych kalorii wzrasta wraz z poziomem doświadczenia – eksperci spalają znacznie więcej kalorii niż średniozaawansowani i początkujący. Nie zaobserwowano istotnych różnic w preferencjach typów treningów między kobietami a mężczyznami, a proporcje są zbliżone w obu grupach. Stwierdzono silną, istotną statystycznie zależność między czasem trwania treningu a liczbą spalonych kalorii – dłuższe sesje skutkują większym spalaniem. Analiza wykazała również, że proporcje grup tętna spoczynkowego w różnych kategoriach wiekowych są bardzo podobne i nie różnią się istotnie statystycznie.
